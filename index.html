<!DOCTYPE html>
<html>
<head>
	<title>sheet-music-player</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.css" />
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<div id="app">
		<form id="bellForm">
			<p>音频风格</p>
			<div style="margin: 10px 5px 15px">
				<input type="radio" id="oscTypeSine" name="oscType" value="sine" checked>
				<label for="oscTypeSine">sine</label>
				<input type="radio" id="oscTypeSquare" name="oscType" value="square">
				<label for="oscTypeSquare">square</label>
				<input type="radio" id="oscTypeTriangle" name="oscType" value="triangle">
				<label for="oscTypeTriangle">triangle</label>
				<input type="radio" id="oscTypeSawtooth" name="oscType" value="sawtooth">
				<label for="oscTypeSawtooth">sawtooth</label>
			</div>
			<textarea id="sheetMusic">C4 D4 E4</textarea>
			<button type="submit">Play</button>
			<section class="comment">
				支持音名
				C1 - C8 <br>
				升调支持写法 C#1 C♯1 <br>
				降调支持写法 D.1 D♭1 <br>
				间隔时间时长用“空格”或“-”计算 <br> 
				注意：每个音必须用 空格隔开
			</section>
		</form>
	</div>
	<script type="module">
		import { playAudio } from './js/piano.js'
		import defaultNote from './sheet/这一生关于你的风景.js'

		const $ = document.querySelector.bind(document)

		const bellForm = $('#bellForm')
		let sheetMusic = ''

		addPlayEvent()

		function addPlayEvent () {
			bellForm.addEventListener('submit', playEvent)

			if (defaultNote) {
				$('#sheetMusic').value = defaultNote.trim()
			}
		}

		function playEvent (ev) {
			sheetMusic = $('#sheetMusic').value

			let formData = new FormData(bellForm)
			let oscType = [...formData][0][1]

			playAudio(sheetMusic, oscType)

  		ev.preventDefault()
		}

	</script>
</body>
</html>
